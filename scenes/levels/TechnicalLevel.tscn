[gd_scene load_steps=16 format=3 uid="uid://dtechlabyrinth1"]

[ext_resource type="Script" path="res://scripts/levels/technical_level.gd" id="1_technical_level"]
[ext_resource type="PackedScene" uid="uid://dv8nq2vj5r7p2" path="res://scenes/characters/csharp/Player.tscn" id="2_player"]
[ext_resource type="PackedScene" uid="uid://cx5m8np6u3bwd" path="res://scenes/ui/PauseMenu.tscn" id="3_pause_menu"]
[ext_resource type="PackedScene" uid="uid://dxqmk8f3nw5pe" path="res://scenes/objects/Enemy.tscn" id="4_enemy"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_horizontal"]
size = Vector2(4064, 32)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_vertical"]
size = Vector2(32, 664)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_divider_v"]
size = Vector2(24, 280)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_cover_crate"]
size = Vector2(64, 64)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_cover_pipe"]
size = Vector2(24, 120)

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_wall_horizontal"]
polygon = PackedVector2Array(-2032, -16, 2032, -16, 2032, 16, -2032, 16)

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_wall_vertical"]
polygon = PackedVector2Array(-16, -332, 16, -332, 16, 332, -16, 332)

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_cover_crate"]
polygon = PackedVector2Array(-32, -32, 32, -32, 32, 32, -32, 32)

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_cover_pipe"]
polygon = PackedVector2Array(-12, -60, 12, -60, 12, 60, -12, 60)

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_divider_v"]
polygon = PackedVector2Array(-12, -140, 12, -140, 12, 140, -12, 140)

[sub_resource type="NavigationPolygon" id="NavigationPolygon_level"]
vertices = PackedVector2Array(64, 64, 3936, 64, 3936, 536, 64, 536)
polygons = [PackedInt32Array(0, 1, 2, 3)]
outlines = [PackedVector2Array(64, 64, 3936, 64, 3936, 536, 64, 536)]
parsed_geometry_type = 1
parsed_collision_mask = 4
source_geometry_mode = 0
source_geometry_group_name = &"navigation_source"
agent_radius = 24.0

[node name="TechnicalLevel" type="Node2D"]
script = ExtResource("1_technical_level")

[node name="Environment" type="Node2D" parent="."]

[node name="Background" type="ColorRect" parent="Environment"]
offset_right = 4000.0
offset_bottom = 600.0
color = Color(0.04, 0.04, 0.06, 1)

[node name="Floor" type="ColorRect" parent="Environment"]
offset_left = 64.0
offset_top = 64.0
offset_right = 3936.0
offset_bottom = 536.0
color = Color(0.14, 0.14, 0.16, 1)

[node name="Walls" type="Node2D" parent="Environment"]

[node name="WallTop" type="StaticBody2D" parent="Environment/Walls"]
position = Vector2(2000, 48)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Walls/WallTop"]
offset_left = -2032.0
offset_top = -16.0
offset_right = 2032.0
offset_bottom = 16.0
color = Color(0.25, 0.25, 0.28, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Walls/WallTop"]
shape = SubResource("RectangleShape2D_wall_horizontal")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Walls/WallTop"]
occluder = SubResource("OccluderPolygon2D_wall_horizontal")

[node name="WallBottom" type="StaticBody2D" parent="Environment/Walls"]
position = Vector2(2000, 552)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Walls/WallBottom"]
offset_left = -2032.0
offset_top = -16.0
offset_right = 2032.0
offset_bottom = 16.0
color = Color(0.25, 0.25, 0.28, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Walls/WallBottom"]
shape = SubResource("RectangleShape2D_wall_horizontal")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Walls/WallBottom"]
occluder = SubResource("OccluderPolygon2D_wall_horizontal")

[node name="WallLeft" type="StaticBody2D" parent="Environment/Walls"]
position = Vector2(48, 300)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Walls/WallLeft"]
offset_left = -16.0
offset_top = -332.0
offset_right = 16.0
offset_bottom = 332.0
color = Color(0.25, 0.25, 0.28, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Walls/WallLeft"]
shape = SubResource("RectangleShape2D_wall_vertical")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Walls/WallLeft"]
occluder = SubResource("OccluderPolygon2D_wall_vertical")

[node name="WallRight" type="StaticBody2D" parent="Environment/Walls"]
position = Vector2(3952, 300)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Walls/WallRight"]
offset_left = -16.0
offset_top = -332.0
offset_right = 16.0
offset_bottom = 332.0
color = Color(0.25, 0.25, 0.28, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Walls/WallRight"]
shape = SubResource("RectangleShape2D_wall_vertical")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Walls/WallRight"]
occluder = SubResource("OccluderPolygon2D_wall_vertical")

[node name="InteriorWalls" type="Node2D" parent="Environment"]

[node name="Divider1" type="StaticBody2D" parent="Environment/InteriorWalls"]
position = Vector2(1000, 100)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/InteriorWalls/Divider1"]
offset_left = -12.0
offset_top = -140.0
offset_right = 12.0
offset_bottom = 140.0
color = Color(0.3, 0.3, 0.33, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/InteriorWalls/Divider1"]
shape = SubResource("RectangleShape2D_divider_v")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/InteriorWalls/Divider1"]
occluder = SubResource("OccluderPolygon2D_divider_v")

[node name="Divider2" type="StaticBody2D" parent="Environment/InteriorWalls"]
position = Vector2(2000, 500)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/InteriorWalls/Divider2"]
offset_left = -12.0
offset_top = -140.0
offset_right = 12.0
offset_bottom = 140.0
color = Color(0.3, 0.3, 0.33, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/InteriorWalls/Divider2"]
shape = SubResource("RectangleShape2D_divider_v")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/InteriorWalls/Divider2"]
occluder = SubResource("OccluderPolygon2D_divider_v")

[node name="Divider3" type="StaticBody2D" parent="Environment/InteriorWalls"]
position = Vector2(3000, 100)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/InteriorWalls/Divider3"]
offset_left = -12.0
offset_top = -140.0
offset_right = 12.0
offset_bottom = 140.0
color = Color(0.3, 0.3, 0.33, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/InteriorWalls/Divider3"]
shape = SubResource("RectangleShape2D_divider_v")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/InteriorWalls/Divider3"]
occluder = SubResource("OccluderPolygon2D_divider_v")

[node name="Cover" type="Node2D" parent="Environment"]

[node name="Crate1" type="StaticBody2D" parent="Environment/Cover"]
position = Vector2(600, 200)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Cover/Crate1"]
offset_left = -32.0
offset_top = -32.0
offset_right = 32.0
offset_bottom = 32.0
color = Color(0.35, 0.32, 0.28, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Cover/Crate1"]
shape = SubResource("RectangleShape2D_cover_crate")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Cover/Crate1"]
occluder = SubResource("OccluderPolygon2D_cover_crate")

[node name="Pipe1" type="StaticBody2D" parent="Environment/Cover"]
position = Vector2(1500, 400)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Cover/Pipe1"]
offset_left = -12.0
offset_top = -60.0
offset_right = 12.0
offset_bottom = 60.0
color = Color(0.4, 0.38, 0.35, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Cover/Pipe1"]
shape = SubResource("RectangleShape2D_cover_pipe")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Cover/Pipe1"]
occluder = SubResource("OccluderPolygon2D_cover_pipe")

[node name="Crate2" type="StaticBody2D" parent="Environment/Cover"]
position = Vector2(2400, 200)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Cover/Crate2"]
offset_left = -32.0
offset_top = -32.0
offset_right = 32.0
offset_bottom = 32.0
color = Color(0.35, 0.32, 0.28, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Cover/Crate2"]
shape = SubResource("RectangleShape2D_cover_crate")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Cover/Crate2"]
occluder = SubResource("OccluderPolygon2D_cover_crate")

[node name="Pipe2" type="StaticBody2D" parent="Environment/Cover"]
position = Vector2(2700, 350)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Cover/Pipe2"]
offset_left = -12.0
offset_top = -60.0
offset_right = 12.0
offset_bottom = 60.0
color = Color(0.4, 0.38, 0.35, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Cover/Pipe2"]
shape = SubResource("RectangleShape2D_cover_pipe")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Cover/Pipe2"]
occluder = SubResource("OccluderPolygon2D_cover_pipe")

[node name="Crate3" type="StaticBody2D" parent="Environment/Cover"]
position = Vector2(3500, 400)
collision_layer = 4
collision_mask = 0

[node name="ColorRect" type="ColorRect" parent="Environment/Cover/Crate3"]
offset_left = -32.0
offset_top = -32.0
offset_right = 32.0
offset_bottom = 32.0
color = Color(0.35, 0.32, 0.28, 1)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Environment/Cover/Crate3"]
shape = SubResource("RectangleShape2D_cover_crate")

[node name="LightOccluder2D" type="LightOccluder2D" parent="Environment/Cover/Crate3"]
occluder = SubResource("OccluderPolygon2D_cover_crate")

[node name="Enemies" type="Node2D" parent="Environment"]

[node name="Enemy1" parent="Environment/Enemies" instance=ExtResource("4_enemy")]
position = Vector2(900, 350)
behavior_mode = 1
weapon_type = 0
min_health = 1
max_health = 2
destroy_on_death = true
enable_flanking = true
enable_cover = true

[node name="Enemy2" parent="Environment/Enemies" instance=ExtResource("4_enemy")]
position = Vector2(1800, 200)
behavior_mode = 0
weapon_type = 0
min_health = 1
max_health = 2
patrol_offsets = Array[Vector2]([Vector2(200, 0), Vector2(-200, 0)])
destroy_on_death = true
enable_flanking = true
enable_cover = true

[node name="Enemy3" parent="Environment/Enemies" instance=ExtResource("4_enemy")]
position = Vector2(2600, 400)
behavior_mode = 1
weapon_type = 0
min_health = 1
max_health = 2
destroy_on_death = true
enable_flanking = true
enable_cover = true

[node name="Enemy4" parent="Environment/Enemies" instance=ExtResource("4_enemy")]
position = Vector2(3400, 250)
behavior_mode = 1
weapon_type = 1
min_health = 1
max_health = 2
destroy_on_death = true
enable_flanking = true
enable_cover = true

[node name="NavigationRegion2D" type="NavigationRegion2D" parent="."]
navigation_polygon = SubResource("NavigationPolygon_level")

[node name="Entities" type="Node2D" parent="."]

[node name="Player" parent="Entities" instance=ExtResource("2_player")]
position = Vector2(200, 300)

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="UI" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="LevelLabel" type="Label" parent="CanvasLayer/UI"]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -250.0
offset_top = 10.0
offset_right = -10.0
offset_bottom = 40.0
grow_horizontal = 0
text = "TECHNICAL CORRIDOR"
horizontal_alignment = 2

[node name="EnemyCountLabel" type="Label" parent="CanvasLayer/UI"]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -200.0
offset_top = 45.0
offset_right = -10.0
offset_bottom = 75.0
grow_horizontal = 0
text = "Enemies: 4"
horizontal_alignment = 2

[node name="AmmoLabel" type="Label" parent="CanvasLayer/UI"]
layout_mode = 1
anchors_preset = 0
offset_left = 10.0
offset_top = 10.0
offset_right = 200.0
offset_bottom = 45.0
text = "AMMO: 30/30"

[node name="PauseMenu" parent="." instance=ExtResource("3_pause_menu")]
